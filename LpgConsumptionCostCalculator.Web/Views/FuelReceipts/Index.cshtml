@model IEnumerable<LpgConsumptionCostCalculator.Web.ViewModels.FuelReceiptViewModel>
@using LpgConsumptionCostCalculator.Data.Models

@{
    ViewBag.Title = "List of fuel receipts";
    var queryOptions = (QueryOptions)ViewBag.QueryOptions;
}
<h1 class="display-4">@ViewBag.Title</h1>

@if (Model != null)
{
    @Html.ActionLink("Create New", "Create", new { id = ViewBag.CarId }, new { @class = "btn btn-outline-dark" })
    <p></p>

    using (Html.BeginForm("Index", "FuelReceipts", FormMethod.Get))
    {
        <div class="form-horizontal">
            <div class="form-row">
                <input type="text" name="searchString" class="form-control form-control-sm" />
                <input type="submit" value="Search" id="btnSubmit" class="btn btn-outline-dark btn-sm" />
            </div>
        </div>
    }

    <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th>
                    @Html.BuildSortableLink("Date", "Index", "RefuelingDate", queryOptions)
                </th>
                <th>
                    @Html.BuildSortableLink("Station name", "Index", "PetrolStationName", queryOptions)
                </th>
                <th>
                    @Html.BuildSortableLink("Fuel price", "Index", "FuelPrice", queryOptions)
                </th>
                <th>
                    @Html.BuildSortableLink("Fuel amount", "Index", "FuelAmount", queryOptions)
                </th>
                <th>
                    @Html.BuildSortableLink("Consumption per 100 km", "Index", "FuelConsumption", queryOptions)
                </th>
                <th>
                    @Html.BuildSortableLink("Total price per 100 km", "Index", "PriceFor100km", queryOptions)
                </th>
                <th>
                    Actions
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        <b>@Html.ValueFor(modelItem => item.RefuelingDate, "{0:yyyy/MM/dd}")</b>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PetrolStationName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.FuelPrice)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.FuelAmount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.FuelConsumption)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PriceFor100km)
                    </td>
                    <td>
                        <input class="btn btn-outline-dark btn-sm" type="button" value="Details" id="@item.Id" onclick="FuelReceiptDetailsAsModal(this.id)">
                        @Html.ActionLink("Edit", "Edit", new { id = item.Id }, new { @class = "btn btn-outline-dark btn-sm" })
                        <input class="btn btn-outline-dark btn-sm" type="button" value="Delete" id="@item.Id" onclick="FuelReceiptDeleteAsModal(this.id)">
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <div class="container-fluid">
        <div class="row justify-content-md-end">
            <div class="col-md-auto">
                @Html.BuildPaginationDetails(queryOptions, "Index")
            </div>
            <div class="col-md-auto">
                @Html.BuildNextPreviousLinks(queryOptions, "Index")
            </div>
        </div>
    </div>
}

<!-- Modal -->
<div id="Modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                ...
            </div>
        </div>
    </div>
</div>

@section scripts{
<script>
    function FuelReceiptDeleteAsModal(id) {
        $.get("@Url.Action("Delete","FuelReceipts")/" + id,
            function (data) { $('.modal-body').html(data); })
        $('#Modal').modal('show');
    }

    function FuelReceiptDetailsAsModal(id) {
        $.get("@Url.Action("Details","FuelReceipts")/" + id,
            function (data) { $('.modal-body').html(data); })
        $('#Modal').modal('show');
    }

    $('#Modal').on('hidden.bs.modal', function (e) {
        $('.modal-body').html("")
    })
</script>
}